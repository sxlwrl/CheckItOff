<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="icon" href="/img/head_icon.jpg" />
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600&display=swap"
      rel="stylesheet"
    />
    <title>CheckItOff</title>
      <script>
          function toggleForm() {
              const form = document.getElementById('taskForm');
              const btn = document.getElementById('addTask');
              form.classList.toggle('hidden');
              btn.classList.toggle('hidden');
          }

          function hideForm() {
              const form = document.getElementById('taskForm');
              const btn = document.getElementById('addTask');
              form.classList.add('hidden');
              btn.classList.toggle('hidden');
          }
      </script>
  </head>
  <body>
    <header>
      <p>USERNAME: {{user.USERNAME}}</p>
      <button><a href="/auth/logout">Logout</a></button>
    </header>
    <h2>Task List</h2>
    <ul>
        {{#each tasks}}
            <li style="display: flex; gap: 15px; margin-bottom: 10px; margin-left: 15px">
                <p>{{this.task_name}}</p>
                <p>{{this.task_description}}</p>
                <p>{{this.task_priority}}</p>
                <p>{{this.task_status}}</p>
                <p>{{this.date}}</p>
                <a href="/main/task/{{this.task_id}}/edit">Edit</a>
                <form action="/main/task/{{this.task_id}}/delete" method="POST">
                    <button type="submit" id="deleteBtn" class="hidden">Delete</button>
                </form>
            </li>
        {{/each}}
    </ul>
    {{#if editing}}
        <h2>Edit Task</h2>
    {{else}}
        <h2>Add Task</h2>
        <button id="addTask" onclick="toggleForm()">Add Task</button>
    {{/if}}

    {{#if editing}}
        <form id="taskForm" action="/main/task/{{taskID}}" method="POST" class="">
    {{else}}
        <form id="taskForm" action="/main/task" method="POST" class="hidden">
    {{/if}}
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>
        <label for="description">Description:</label>
        <input type="text" id="description" name="description">
        <label for="priority">Priority:</label>
        <select id="priority" name="priority" required>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
        <label for="status">Status:</label>
        <input type="text" id="status" name="status" required>
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" required>
    {{#if editing}}
            <button type="submit">Edit Task</button>
    {{else}}
            <button type="submit">Add Task</button>
    {{/if}}
    {{#if editing}}
            <button><a href="/main">Cancel</a></button>
        </form>
    {{else}}
            <button type="button" onclick="hideForm()">Cancel</button>
        </form>
    {{/if}}

  </body>
</html>